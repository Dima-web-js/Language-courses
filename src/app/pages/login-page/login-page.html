<div class="login-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Вход</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <form (submit)="onSubmit($event)" class="login-form">
        @if (errorMessage()) {
          <div class="error-banner">{{ errorMessage() }}</div>
        }

        <mat-form-field>
          <mat-label>Email (логин)</mat-label>
          <input
            matInput
            type="email"
            [formField]="loginForm.email"
            placeholder="student@school.com"
            autocomplete="email"
            (focus)="clearErrorOnFieldTouch()"
          />
          @if (loginForm.email().touched() && loginForm.email().invalid()) {
            <mat-error>
              @for (err of loginForm.email().errors(); track err.message) {
                {{ err.message }}
              }
            </mat-error>
          }
        </mat-form-field>

        <mat-form-field>
          <mat-label>Пароль</mat-label>
          <input
            matInput
            [type]="passwordVisible() ? 'text' : 'password'"
            [formField]="loginForm.password"
            placeholder="Пароль"
            autocomplete="current-password"
            (focus)="clearErrorOnFieldTouch()"
          />
          <button
            mat-icon-button
            matSuffix
            type="button"
            (click)="togglePasswordVisibility()"
            [attr.aria-label]="passwordVisible() ? 'Скрыть пароль' : 'Показать пароль'"
          >
            <mat-icon>{{ passwordVisible() ? 'visibility_off' : 'visibility' }}</mat-icon>
          </button>
          @if (loginForm.password().touched() && loginForm.password().invalid()) {
            <mat-error>
              @for (err of loginForm.password().errors(); track err.message) {
                {{ err.message }}
              }
            </mat-error>
          }
        </mat-form-field>

        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="loading()"
        >
          {{ loading() ? 'Вход...' : 'Войти' }}
        </button>
      </form>
    </mat-card-content>
  </mat-card>
</div>
